<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>DJ Neon Millennium Countdown</title>

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Audiowide&display=swap" rel="stylesheet">

<style>
body {
    margin:0;
    background:#060816;
    color:white;
    font-family:sans-serif;
    overflow:hidden;
}

#header {
    text-align:center;
    font-family:'Audiowide';
    font-size:28px;
    padding-top:15px;
    color:#00f7ff;
    text-shadow:0 0 15px #00f7ff;
}

#countdown {
    text-align:center;
    font-family:'Orbitron';
    font-size:90px;
    margin-top:20px;
    background: linear-gradient(to bottom, #fff, #aaa);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    text-shadow:0 0 30px #ff00ff;
}

#equalizer {
    position:absolute;
    top:180px;
    width:100%;
    height:120px;
    display:flex;
    justify-content:center;
    gap:6px;
}

.bar {
    width:8px;
    background:#00f7ff;
    animation: bounce 1s infinite ease-in-out;
}

@keyframes bounce {
    0%,100% {height:20px;}
    50% {height:100px;}
}

#photos {
    position:absolute;
    bottom:120px;
    width:100%;
    display:grid;
    grid-template-columns: repeat(10, 1fr);
    gap:10px;
    padding:20px;
}

.polaroid {
    background:white;
    color:black;
    padding:8px;
    box-shadow:0 0 15px #ff00ff;
    transform:rotate(calc(-3deg + 6deg * var(--rand)));
}

.polaroid img {
    width:100%;
    height:120px;
    object-fit:cover;
}

.name {
    font-family:'Audiowide';
    font-size:12px;
}

.real {
    font-size:11px;
}

#spotlight {
    position:absolute;
    bottom:60px;
    left:20px;
    font-size:16px;
    max-width:500px;
}

#ticker {
    position:absolute;
    bottom:0;
    width:100%;
    background:black;
    color:#00ff88;
    white-space:nowrap;
    overflow:hidden;
}

#ticker span {
    display:inline-block;
    padding-left:100%;
    animation: ticker 20s linear infinite;
}

@keyframes ticker {
    0% {transform:translateX(0);}
    100% {transform:translateX(-100%);}
}

#y2k {
    position:absolute;
    top:0;
    left:0;
    width:100%;
    height:100%;
    background:black;
    display:none;
    justify-content:center;
    align-items:center;
    font-family:'Orbitron';
    font-size:60px;
    color:#00ffcc;
}
</style>
</head>
<body>

<div id="header">DJ NEON'S MILLENNIUM COUNTDOWN</div>
<div id="countdown"></div>

<div id="equalizer"></div>
<div id="photos"></div>
<div id="spotlight"></div>

<div id="ticker">
    <span>
        MusicNetHub â–² 32% | Sterling Soundscapes â–¼ 12% | Napster Lawsuit Pending | Y2K Bug Risk: CRITICAL | ARE WE READY?
    </span>
</div>

<div id="y2k">WELCOME TO 2000</div>

<script>
const sheetURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vR2-PvhqluJKo9Fg8Oxx9t5GlTvA9zv8bUm1DVHVnlc_4R2T2Jdtip1hmUVJvHI6Ik6T69VT_Bn270R/pub?output=csv";

const targetHour = 22;
const targetMinute = 0;

function updateCountdown(){
    const now = new Date();
    const target = new Date();
    target.setHours(targetHour);
    target.setMinutes(targetMinute);
    target.setSeconds(0);

    const diff = target - now;

    if(diff <= 0){
        document.getElementById("y2k").style.display="flex";
        return;
    }

    const hrs = Math.floor(diff/1000/60/60);
    const mins = Math.floor(diff/1000/60)%60;
    const secs = Math.floor(diff/1000)%60;

    document.getElementById("countdown").innerText =
        String(hrs).padStart(2,"0")+":"+
        String(mins).padStart(2,"0")+":"+
        String(secs).padStart(2,"0");
}

setInterval(updateCountdown,1000);
updateCountdown();

for(let i=0;i<40;i++){
    const bar = document.createElement("div");
    bar.className="bar";
    bar.style.animationDelay = (Math.random()*1)+"s";
    document.getElementById("equalizer").appendChild(bar);
}

function convertDriveLink(url){
    const match = url.match(/\/d\/(.*?)\//);
    if(match) return "https://drive.google.com/uc?export=view&id="+match[1];
    return url;
}

// Proper CSV parser
function parseCSV(text){
    const rows = [];
    const pattern = /("([^"]|"")*"|[^,\n]*)(,|\n)/g;
    let row = [];
    let match;

    while((match = pattern.exec(text))){
        let value = match[1];
        if(value.startsWith('"') && value.endsWith('"')){
            value = value.slice(1,-1).replace(/""/g,'"');
        }
        row.push(value);

        if(match[3] === "\n"){
            rows.push(row);
            row = [];
        }
    }
    return rows;
}

let spotlightIndex = 0;
let spotlightGuests = [];

function rotateSpotlight(){
    if(spotlightGuests.length === 0) return;

    const g = spotlightGuests[spotlightIndex % spotlightGuests.length];

    document.getElementById("spotlight").innerHTML =
        "<b>ðŸ”¦ CLUB SPOTLIGHT</b><br>"+
        g.name+" â€“ "+g.title+"<br>"+
        "\""+g.desc+"\"";

    spotlightIndex++;
}

setInterval(rotateSpotlight,8000);

async function loadSheet(){
    const response = await fetch(sheetURL);
    const text = await response.text();
    const rows = parseCSV(text);

    const container = document.getElementById("photos");
    container.innerHTML = "";

    spotlightGuests = [];

    for(let i=1;i<rows.length;i++){
        const row = rows[i];
        if(row.length < 5) continue;

        const character = row[0];
        const title = row[1];
        const desc = row[2];
        const real = row[3];
        const photo = row[4];

        if(real && photo){
            const div = document.createElement("div");
            div.className="polaroid";
            div.style.setProperty('--rand', Math.random());

            const img = document.createElement("img");
            img.src = convertDriveLink(photo);
            div.appendChild(img);

            const name = document.createElement("div");
            name.className="name";
            name.innerText = character;
            div.appendChild(name);

            const realDiv = document.createElement("div");
            realDiv.className="real";
            realDiv.innerText = real;
            div.appendChild(realDiv);

            container.appendChild(div);

            spotlightGuests.push({
                name: character,
                title: title,
                desc: desc
            });
        }
    }
}

setInterval(loadSheet,15000);
loadSheet();
</script>

</body>
</html>
